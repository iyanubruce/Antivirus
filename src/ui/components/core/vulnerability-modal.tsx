import React from "react";
import { Vulnerability } from "../../types/interfaces";

interface VulnerabilityModalProps {
  theme: "light" | "dark";
  vulnerability: Vulnerability | null;
  onClose: () => void;
}

export const VulnerabilityModal: React.FC<VulnerabilityModalProps> = ({
  theme,
  vulnerability,
  onClose,
}) => {
  if (!vulnerability) return null;

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div
        className={`max-w-2xl w-full mx-4 rounded-lg ${
          theme === "light" ? "bg-white" : "bg-gray-800"
        } shadow-xl`}
      >
        <div className="p-6">
          <div className="flex justify-between items-start mb-4">
            <div>
              <h3 className="text-xl font-semibold">{vulnerability.id}</h3>
              <p
                className={`text-sm ${
                  theme === "light" ? "text-gray-600" : "text-gray-400"
                } mt-1`}
              >
                {vulnerability.affectedComponent || "Unknown Component"}
              </p>
            </div>
            <button
              onClick={onClose}
              className={`p-2 rounded-full ${
                theme === "light" ? "hover:bg-gray-100" : "hover:bg-gray-700"
              } !rounded-button whitespace-nowrap`}
            >
              <i className="fas fa-times"></i>
            </button>
          </div>
          <div className="space-y-4">
            <div>
              <h4 className="font-medium mb-2">Description</h4>
              <p
                className={`text-sm ${
                  theme === "light" ? "text-gray-600" : "text-gray-400"
                }`}
              >
                {vulnerability.description}
              </p>
            </div>
            <div>
              <h4 className="font-medium mb-2">CVSS Score</h4>
              <div className="flex items-center">
                <div
                  className={`px-3 py-1 rounded-full text-sm ${
                    vulnerability.cvssScore && vulnerability.cvssScore < 4
                      ? "bg-yellow-100 text-yellow-800"
                      : vulnerability.cvssScore && vulnerability.cvssScore < 7
                      ? "bg-orange-100 text-orange-800"
                      : "bg-red-100 text-red-800"
                  }`}
                >
                  {vulnerability.cvssScore?.toFixed(1) || "N/A"}
                </div>
              </div>
            </div>
            <div>
              <h4 className="font-medium mb-2">Severity</h4>
              <p
                className={`text-sm ${
                  theme === "light" ? "text-gray-600" : "text-gray-400"
                }`}
              >
                {vulnerability.severity || "Unknown"}
              </p>
            </div>
          </div>
          <div className="mt-6 flex justify-end">
            <button
              onClick={onClose}
              className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors !rounded-button whitespace-nowrap"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};
